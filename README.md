# CleverProfits Customer Portal

A customer portal for viewing monthly financial review packages generated by Claude API.

## Tech Stack

- **Frontend**: Next.js 15, React 19, TypeScript, Tailwind CSS
- **Backend**: Next.js API Routes
- **Database**: PostgreSQL (Supabase)
- **Authentication**: Clerk
- **AI**: Claude API (Anthropic)
- **Storage**: Supabase Storage
- **Hosting**: Vercel

## Prerequisites

- Node.js 18+
- Supabase account
- Clerk account
- Anthropic API key

## Quick Start

### 1. Clone and Install

```bash
git clone <your-repo-url>
cd cleverprofits-portal
npm install
```

### 2. Configure Environment

Copy the example environment file:

```bash
cp .env.example .env.local
```

Fill in your credentials:

```env
# Clerk
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxx
CLERK_SECRET_KEY=sk_test_xxxxx

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxxxx
SUPABASE_SERVICE_ROLE_KEY=eyJxxxxx
DATABASE_URL="postgresql://postgres:xxxxx@db.xxxxx.supabase.co:5432/postgres"

# Anthropic
ANTHROPIC_API_KEY=sk-ant-xxxxx
```

### 3. Set Up Database

Push the Prisma schema to your database:

```bash
npx prisma db push
npx prisma generate
```

### 4. Create Supabase Storage Bucket

1. Go to Supabase Dashboard → Storage
2. Create a new bucket: `cleverprofits-files`
3. Set bucket to private

### 5. Run Development Server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

## Project Structure

```
src/
├── app/                    # Next.js App Router
│   ├── api/               # API routes
│   ├── dashboard/         # Customer dashboard
│   ├── reports/           # Report viewer
│   ├── admin/             # Admin panel
│   └── sign-in/           # Authentication
├── components/            # React components
│   └── ui/                # shadcn/ui components
├── lib/                   # Core utilities
│   ├── db.ts             # Prisma client
│   ├── storage.ts        # Supabase storage
│   ├── excel.ts          # Excel processing
│   ├── claude.ts         # Claude API
│   └── utils.ts          # Helpers
└── types/                 # TypeScript types
```

## Key Features

### Customer Portal
- View monthly financial review reports
- Navigate report sections (Executive Snapshot, Revenue, etc.)
- Download Excel source files
- Access historical reports

### Admin Panel
- Upload client Excel workbooks
- Configure metrics per client
- Generate reports via Claude API
- Publish reports to customers

### Report Generation
1. Admin uploads Excel workbook
2. System extracts core financial sheets (7-8 sheets)
3. Claude API analyzes data with Big 4-style prompt
4. Structured report saved to database
5. Admin publishes to customer portal

## Development

### Database Migrations

```bash
# Push schema changes
npx prisma db push

# Generate client
npx prisma generate

# Open Prisma Studio
npx prisma studio
```

### Adding UI Components

Using shadcn/ui pattern - create components in `src/components/ui/`

### Testing Claude Integration

```bash
# Run the test script
npm run test:claude
```

## Deployment

### Vercel

1. Connect GitHub repo to Vercel
2. Add environment variables
3. Deploy

### Environment Variables (Production)

- `DATABASE_URL` - Supabase connection string
- `NEXT_PUBLIC_SUPABASE_URL` - Supabase project URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY` - Supabase anon key
- `SUPABASE_SERVICE_ROLE_KEY` - Supabase service role key
- `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` - Clerk publishable key
- `CLERK_SECRET_KEY` - Clerk secret key
- `ANTHROPIC_API_KEY` - Claude API key

## License

Private - CleverProfits

## Support

Contact: [your-email]
